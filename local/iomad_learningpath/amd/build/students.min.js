define(["jquery","jqueryui","core/config","core/ajax","core/notification"],function(e,i,t,n,o){return{init:function(i,t){function a(){var a=e("#userfilter").val(),s=e("#profilefieldid").val();n.call([{methodname:"local_iomad_learningpath_getprospectiveusers",args:{companyid:i,pathid:t,filter:a,profilefieldid:s},done:function(i){!function(i){if(e("#prospectivelist li").remove(),!i.length)return e("#noprospective").show(),void e("#toomanyprospective").hide();if(e("#noprospective").hide(),i.length>30)e("#toomanyprospective").show();else{e("#toomanyprospective").hide();var t=[];e.each(i,function(e,i){t.push('<li class="text-truncate" data-userid="'+i.id+'"><i class="fa fa-user"></i> '+i.fullname+"</li>")}),e("#prospectivelist").append(t.join(""))}}(i)},fail:o.exception}])}function s(){n.call([{methodname:"local_iomad_learningpath_getusers",args:{companyid:i,pathid:t},done:function(i){!function(i){if(e("#pathuserlist li").remove(),i.length){e("#nopathusers").hide();var t=[];e.each(i,function(e,i){t.push('<li class="text-truncate" data-userid="'+i.id+'"><i class="fa fa-user"></i> '+i.fullname+"</li>")}),e("#pathuserlist").append(t.join(""))}else e("#nopathusers").show()}(i)},fail:o.exception}])}e(window).on("load",a()),e("#userfilter").on("input",function(){a()}),e("#profilefieldid").on("change",function(){a()}),e("#prospectivelist, #pathuserlist").on("mouseenter","li",function(){e(this).addClass("text-primary")}),e("#prospectivelist, #pathuserlist").on("mouseleave","li",function(){e(this).removeClass("text-primary")}),e(window).on("load",s()),e("#prospectivelist").on("click","li",function(){var i=e(this).data("userid");n.call([{methodname:"local_iomad_learningpath_addusers",args:{pathid:t,userids:[i]},done:function(){s(),a()},fail:o.exception}])}),e("#pathuserlist").on("click","li",function(){var i=e(this).data("userid");n.call([{methodname:"local_iomad_learningpath_removeusers",args:{pathid:t,userids:[i]},done:function(){s(),a()},fail:o.exception}])})}}});
